-- --------------------------------------------------------
-- Host:                         127.0.0.1
-- Versión del servidor:         10.4.10-MariaDB-log - mariadb.org binary distribution
-- SO del servidor:              Win64
-- HeidiSQL Versión:             10.2.0.5599
-- --------------------------------------------------------

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET NAMES utf8 */;
/*!50503 SET NAMES utf8mb4 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;


-- Volcando estructura de base de datos para nutricion
CREATE DATABASE IF NOT EXISTS `nutricion` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_spanish_ci */;
USE `nutricion`;

-- Volcando estructura para tabla nutricion.dim_horario
CREATE TABLE IF NOT EXISTS `dim_horario` (
  `id` int(11) NOT NULL,
  `alias` varchar(100) COLLATE utf8mb4_spanish_ci NOT NULL DEFAULT '',
  `nombre` varchar(150) COLLATE utf8mb4_spanish_ci NOT NULL DEFAULT '',
  `porcentaje` decimal(5,2) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.dim_horario: ~5 rows (aproximadamente)
/*!40000 ALTER TABLE `dim_horario` DISABLE KEYS */;
INSERT INTO `dim_horario` (`id`, `alias`, `nombre`, `porcentaje`) VALUES
	(1, 'DESAYUNO', 'DESAYUNO', 0.20),
	(2, 'COLACION1', 'COLACION 1', 0.10),
	(3, 'ALMUERZO', 'ALMUERZO', 0.35),
	(4, 'COLACION2', 'COLACION 2', 0.10),
	(5, 'CENA', 'CENA', 0.25);
/*!40000 ALTER TABLE `dim_horario` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.dim_horario_producto_restriccion
CREATE TABLE IF NOT EXISTS `dim_horario_producto_restriccion` (
  `idproducto` int(11) NOT NULL,
  `idhorario` int(11) DEFAULT NULL,
  `consumir` tinyint(1) DEFAULT NULL,
  KEY `fk_producto_idproducto` (`idproducto`),
  KEY `fk_horario_idhorario` (`idhorario`),
  CONSTRAINT `fk_horario_idhorario` FOREIGN KEY (`idhorario`) REFERENCES `dim_horario` (`id`),
  CONSTRAINT `fk_producto_idproducto` FOREIGN KEY (`idproducto`) REFERENCES `dim_producto` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.dim_horario_producto_restriccion: ~420 rows (aproximadamente)
/*!40000 ALTER TABLE `dim_horario_producto_restriccion` DISABLE KEYS */;
INSERT INTO `dim_horario_producto_restriccion` (`idproducto`, `idhorario`, `consumir`) VALUES
	(1, 1, 0),
	(2, 1, 1),
	(3, 1, 0),
	(4, 1, 0),
	(5, 1, 0),
	(6, 1, 1),
	(7, 1, 1),
	(8, 1, 1),
	(9, 1, 1),
	(10, 1, 0),
	(11, 1, 0),
	(12, 1, 0),
	(13, 1, 0),
	(14, 1, 0),
	(15, 1, 0),
	(16, 1, 0),
	(17, 1, 0),
	(18, 1, 0),
	(19, 1, 0),
	(20, 1, 0),
	(21, 1, 0),
	(22, 1, 0),
	(23, 1, 0),
	(24, 1, 0),
	(25, 1, 0),
	(26, 1, 0),
	(27, 1, 0),
	(28, 1, 0),
	(29, 1, 1),
	(30, 1, 1),
	(31, 1, 1),
	(32, 1, 1),
	(33, 1, 1),
	(34, 1, 1),
	(35, 1, 1),
	(36, 1, 1),
	(37, 1, 1),
	(38, 1, 1),
	(39, 1, 1),
	(40, 1, 1),
	(41, 1, 1),
	(42, 1, 1),
	(43, 1, 1),
	(44, 1, 1),
	(45, 1, 1),
	(46, 1, 1),
	(47, 1, 1),
	(48, 1, 1),
	(49, 1, 1),
	(50, 1, 1),
	(51, 1, 1),
	(52, 1, 1),
	(53, 1, 1),
	(54, 1, 0),
	(55, 1, 0),
	(56, 1, 0),
	(57, 1, 0),
	(58, 1, 0),
	(59, 1, 0),
	(60, 1, 0),
	(61, 1, 0),
	(62, 1, 0),
	(63, 1, 0),
	(64, 1, 1),
	(65, 1, 1),
	(66, 1, 0),
	(67, 1, 0),
	(68, 1, 0),
	(69, 1, 0),
	(70, 1, 1),
	(71, 1, 0),
	(72, 1, 0),
	(73, 1, 0),
	(74, 1, 1),
	(75, 1, 1),
	(76, 1, 1),
	(77, 1, 1),
	(78, 1, 1),
	(79, 1, 1),
	(80, 1, 1),
	(81, 1, 1),
	(82, 1, 0),
	(83, 1, 0),
	(84, 1, 1),
	(1, 2, 0),
	(2, 2, 0),
	(3, 2, 0),
	(4, 2, 0),
	(5, 2, 0),
	(6, 2, 0),
	(7, 2, 0),
	(8, 2, 1),
	(9, 2, 0),
	(10, 2, 0),
	(11, 2, 0),
	(12, 2, 0),
	(13, 2, 0),
	(14, 2, 0),
	(15, 2, 0),
	(16, 2, 0),
	(17, 2, 0),
	(18, 2, 0),
	(19, 2, 0),
	(20, 2, 0),
	(21, 2, 0),
	(22, 2, 0),
	(23, 2, 0),
	(24, 2, 0),
	(25, 2, 0),
	(26, 2, 0),
	(27, 2, 0),
	(28, 2, 0),
	(29, 2, 1),
	(30, 2, 1),
	(31, 2, 1),
	(32, 2, 1),
	(33, 2, 1),
	(34, 2, 1),
	(35, 2, 1),
	(36, 2, 1),
	(37, 2, 1),
	(38, 2, 1),
	(39, 2, 1),
	(40, 2, 1),
	(41, 2, 1),
	(42, 2, 1),
	(43, 2, 1),
	(44, 2, 0),
	(45, 2, 1),
	(46, 2, 1),
	(47, 2, 1),
	(48, 2, 1),
	(49, 2, 1),
	(50, 2, 1),
	(51, 2, 1),
	(52, 2, 1),
	(53, 2, 1),
	(54, 2, 0),
	(55, 2, 0),
	(56, 2, 0),
	(57, 2, 0),
	(58, 2, 0),
	(59, 2, 0),
	(60, 2, 0),
	(61, 2, 0),
	(62, 2, 0),
	(63, 2, 0),
	(64, 2, 0),
	(65, 2, 0),
	(66, 2, 0),
	(67, 2, 0),
	(68, 2, 0),
	(69, 2, 0),
	(70, 2, 0),
	(71, 2, 0),
	(72, 2, 0),
	(73, 2, 0),
	(74, 2, 0),
	(75, 2, 0),
	(76, 2, 1),
	(77, 2, 0),
	(78, 2, 0),
	(79, 2, 0),
	(80, 2, 0),
	(81, 2, 0),
	(82, 2, 1),
	(83, 2, 1),
	(84, 2, 1),
	(1, 3, 1),
	(2, 3, 0),
	(3, 3, 1),
	(4, 3, 1),
	(5, 3, 1),
	(6, 3, 0),
	(7, 3, 1),
	(8, 3, 0),
	(9, 3, 0),
	(10, 3, 1),
	(11, 3, 1),
	(12, 3, 1),
	(13, 3, 1),
	(14, 3, 1),
	(15, 3, 1),
	(16, 3, 1),
	(17, 3, 1),
	(18, 3, 1),
	(19, 3, 1),
	(20, 3, 1),
	(21, 3, 1),
	(22, 3, 1),
	(23, 3, 1),
	(24, 3, 1),
	(25, 3, 1),
	(26, 3, 1),
	(27, 3, 1),
	(28, 3, 1),
	(29, 3, 0),
	(30, 3, 0),
	(31, 3, 0),
	(32, 3, 0),
	(33, 3, 0),
	(34, 3, 0),
	(35, 3, 0),
	(36, 3, 0),
	(37, 3, 0),
	(38, 3, 0),
	(39, 3, 0),
	(40, 3, 0),
	(41, 3, 0),
	(42, 3, 0),
	(43, 3, 0),
	(44, 3, 1),
	(45, 3, 0),
	(46, 3, 0),
	(47, 3, 0),
	(48, 3, 0),
	(49, 3, 0),
	(50, 3, 0),
	(51, 3, 0),
	(52, 3, 0),
	(53, 3, 0),
	(54, 3, 1),
	(55, 3, 1),
	(56, 3, 1),
	(57, 3, 1),
	(58, 3, 1),
	(59, 3, 1),
	(60, 3, 1),
	(61, 3, 1),
	(62, 3, 1),
	(63, 3, 1),
	(64, 3, 1),
	(65, 3, 0),
	(66, 3, 1),
	(67, 3, 1),
	(68, 3, 1),
	(69, 3, 1),
	(70, 3, 1),
	(71, 3, 1),
	(72, 3, 1),
	(73, 3, 1),
	(74, 3, 0),
	(75, 3, 0),
	(76, 3, 0),
	(77, 3, 0),
	(78, 3, 1),
	(79, 3, 1),
	(80, 3, 1),
	(81, 3, 1),
	(82, 3, 1),
	(83, 3, 0),
	(84, 3, 0),
	(1, 4, 0),
	(2, 4, 0),
	(3, 4, 0),
	(4, 4, 0),
	(5, 4, 0),
	(6, 4, 0),
	(7, 4, 0),
	(8, 4, 1),
	(9, 4, 0),
	(10, 4, 0),
	(11, 4, 0),
	(12, 4, 0),
	(13, 4, 0),
	(14, 4, 0),
	(15, 4, 0),
	(16, 4, 0),
	(17, 4, 0),
	(18, 4, 0),
	(19, 4, 0),
	(20, 4, 0),
	(21, 4, 0),
	(22, 4, 0),
	(23, 4, 0),
	(24, 4, 0),
	(25, 4, 0),
	(26, 4, 0),
	(27, 4, 0),
	(28, 4, 0),
	(29, 4, 0),
	(30, 4, 0),
	(31, 4, 0),
	(32, 4, 0),
	(33, 4, 0),
	(34, 4, 0),
	(35, 4, 0),
	(36, 4, 0),
	(37, 4, 0),
	(38, 4, 0),
	(39, 4, 0),
	(40, 4, 0),
	(41, 4, 0),
	(42, 4, 0),
	(43, 4, 0),
	(44, 4, 0),
	(45, 4, 0),
	(46, 4, 0),
	(47, 4, 0),
	(48, 4, 0),
	(49, 4, 0),
	(50, 4, 0),
	(51, 4, 0),
	(52, 4, 0),
	(53, 4, 0),
	(54, 4, 0),
	(55, 4, 0),
	(56, 4, 0),
	(57, 4, 0),
	(58, 4, 0),
	(59, 4, 0),
	(60, 4, 0),
	(61, 4, 0),
	(62, 4, 0),
	(63, 4, 0),
	(64, 4, 1),
	(65, 4, 0),
	(66, 4, 0),
	(67, 4, 0),
	(68, 4, 0),
	(69, 4, 0),
	(70, 4, 0),
	(71, 4, 0),
	(72, 4, 0),
	(73, 4, 0),
	(74, 4, 0),
	(75, 4, 0),
	(76, 4, 1),
	(77, 4, 0),
	(78, 4, 0),
	(79, 4, 0),
	(80, 4, 0),
	(81, 4, 0),
	(82, 4, 1),
	(83, 4, 1),
	(84, 4, 0),
	(1, 5, 0),
	(2, 5, 1),
	(3, 5, 0),
	(4, 5, 1),
	(5, 5, 1),
	(6, 5, 0),
	(7, 5, 0),
	(8, 5, 0),
	(9, 5, 0),
	(10, 5, 1),
	(11, 5, 1),
	(12, 5, 1),
	(13, 5, 1),
	(14, 5, 1),
	(15, 5, 1),
	(16, 5, 1),
	(17, 5, 1),
	(18, 5, 1),
	(19, 5, 1),
	(20, 5, 1),
	(21, 5, 1),
	(22, 5, 1),
	(23, 5, 1),
	(24, 5, 1),
	(25, 5, 1),
	(26, 5, 1),
	(27, 5, 1),
	(28, 5, 1),
	(29, 5, 0),
	(30, 5, 0),
	(31, 5, 0),
	(32, 5, 0),
	(33, 5, 0),
	(34, 5, 0),
	(35, 5, 0),
	(36, 5, 0),
	(37, 5, 0),
	(38, 5, 0),
	(39, 5, 0),
	(40, 5, 0),
	(41, 5, 0),
	(42, 5, 0),
	(43, 5, 0),
	(44, 5, 0),
	(45, 5, 0),
	(46, 5, 0),
	(47, 5, 0),
	(48, 5, 0),
	(49, 5, 0),
	(50, 5, 0),
	(51, 5, 0),
	(52, 5, 0),
	(53, 5, 0),
	(54, 5, 0),
	(55, 5, 0),
	(56, 5, 1),
	(57, 5, 1),
	(58, 5, 1),
	(59, 5, 1),
	(60, 5, 1),
	(61, 5, 1),
	(62, 5, 1),
	(63, 5, 0),
	(64, 5, 0),
	(65, 5, 0),
	(66, 5, 0),
	(67, 5, 0),
	(68, 5, 0),
	(69, 5, 0),
	(70, 5, 1),
	(71, 5, 1),
	(72, 5, 0),
	(73, 5, 0),
	(74, 5, 0),
	(75, 5, 0),
	(76, 5, 0),
	(77, 5, 1),
	(78, 5, 1),
	(79, 5, 1),
	(80, 5, 1),
	(81, 5, 1),
	(82, 5, 0),
	(83, 5, 1),
	(84, 5, 0);
/*!40000 ALTER TABLE `dim_horario_producto_restriccion` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.dim_horario_tipo_restriccion
CREATE TABLE IF NOT EXISTS `dim_horario_tipo_restriccion` (
  `idtipo` int(11) NOT NULL,
  `idhorario` int(11) NOT NULL,
  `maximo` smallint(6) DEFAULT NULL,
  `obligatorio` tinyint(1) DEFAULT NULL,
  KEY `fk_tipo_idtipo1` (`idtipo`),
  KEY `fk_horario_idhorario1` (`idhorario`),
  CONSTRAINT `fk_horario_idhorario1` FOREIGN KEY (`idhorario`) REFERENCES `dim_horario` (`id`),
  CONSTRAINT `fk_tipo_idtipo1` FOREIGN KEY (`idtipo`) REFERENCES `dim_tipo` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.dim_horario_tipo_restriccion: ~45 rows (aproximadamente)
/*!40000 ALTER TABLE `dim_horario_tipo_restriccion` DISABLE KEYS */;
INSERT INTO `dim_horario_tipo_restriccion` (`idtipo`, `idhorario`, `maximo`, `obligatorio`) VALUES
	(1, 1, 1, 1),
	(2, 1, 0, 0),
	(3, 1, 2, 1),
	(4, 1, 0, 0),
	(5, 1, 2, 1),
	(6, 1, 0, 0),
	(7, 1, 1, 0),
	(8, 1, 1, 0),
	(9, 1, 1, 1),
	(1, 2, 1, 0),
	(2, 2, 0, 0),
	(3, 2, 1, 1),
	(4, 2, 0, 0),
	(5, 2, 0, 0),
	(6, 2, 0, 0),
	(7, 2, 0, 0),
	(8, 2, 1, 0),
	(9, 2, 1, 0),
	(1, 3, 1, 1),
	(2, 3, 6, 1),
	(3, 3, 1, 0),
	(4, 3, 1, 1),
	(5, 3, 1, 0),
	(6, 3, 1, 0),
	(7, 3, 1, 0),
	(8, 3, 0, 0),
	(9, 3, 1, 1),
	(1, 4, 1, 0),
	(2, 4, 0, 0),
	(3, 4, 0, 0),
	(4, 4, 0, 0),
	(5, 4, 1, 0),
	(6, 4, 0, 0),
	(7, 4, 0, 0),
	(8, 4, 1, 0),
	(9, 4, 1, 0),
	(1, 5, 1, 0),
	(2, 5, 6, 1),
	(3, 5, 0, 0),
	(4, 5, 1, 1),
	(5, 5, 0, 0),
	(6, 5, 0, 0),
	(7, 5, 1, 0),
	(8, 5, 0, 0),
	(9, 5, 1, 1);
/*!40000 ALTER TABLE `dim_horario_tipo_restriccion` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.dim_producto
CREATE TABLE IF NOT EXISTS `dim_producto` (
  `id` int(11) NOT NULL,
  `nombre` varchar(100) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `medida` varchar(50) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `kcal` int(11) DEFAULT NULL,
  `idtipo` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `dim_producto_dim_tipo_id_fk` (`idtipo`),
  CONSTRAINT `dim_producto_dim_tipo_id_fk` FOREIGN KEY (`idtipo`) REFERENCES `dim_tipo` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.dim_producto: ~84 rows (aproximadamente)
/*!40000 ALTER TABLE `dim_producto` DISABLE KEYS */;
INSERT INTO `dim_producto` (`id`, `nombre`, `medida`, `kcal`, `idtipo`) VALUES
	(1, 'ARROZ BLANCO COCIDO', 'gramos', 115, 1),
	(2, 'AVENA COCIDA', 'gramos', 54, 1),
	(3, 'FIDEO HERVIDO', 'gramos', 90, 1),
	(4, 'CHOCLO HERVIDO', 'gramos', 115, 1),
	(5, 'MOTE HERVIDO', 'gramos', 103, 1),
	(6, 'QUINUA COCIDA', 'gramos', 86, 1),
	(7, 'TRIGO COCIDO', 'gramos', 69, 1),
	(8, 'CEREAL SIN AZÚCAR', 'gramos', 108, 1),
	(9, 'TOSTADA INTEGRAL', 'unidad', 69, 1),
	(10, 'HOJAS DE ACELGA', 'gramos', 27, 2),
	(11, 'ALCACHOFA', 'gramos', 19, 2),
	(12, 'APIO', 'gramos', 21, 2),
	(13, 'BERENJENA', 'gramos', 41, 2),
	(14, 'BRÓCOLI HERVIDO', 'gramos', 40, 2),
	(15, 'CAIGUA HERVIDA', 'gramos', 15, 2),
	(16, 'CEBOLLA', 'gramos', 33, 2),
	(17, 'COL BLANCA', 'gramos', 23, 2),
	(18, 'COLIFLOR', 'gramos', 28, 2),
	(19, 'ESPÁRRAGOS HERVIDOS', 'gramos', 23, 2),
	(20, 'LECHUGA', 'gramos', 12, 2),
	(21, 'NABO', 'gramos', 16, 2),
	(22, 'PEPINILLO', 'gramos', 11, 2),
	(23, 'PORO HERVIDO', 'gramos', 40, 2),
	(24, 'RABANITOS', 'gramos', 14, 2),
	(25, 'TOMATE', 'gramos', 19, 2),
	(26, 'VAINITAS HERVIDAS', 'gramos', 37, 2),
	(27, 'ZANAHORIA HERVIDA', 'gramos', 41, 2),
	(28, 'ZAPALLO HERVIDO', 'gramos', 26, 2),
	(29, 'CHIRIMOYA', 'gramos', 87, 3),
	(30, 'CIRUELA', 'gramos', 82, 3),
	(31, 'COCONA', 'gramos', 41, 3),
	(32, 'FRESA', 'gramos', 41, 3),
	(33, 'GRANADA', 'gramos', 68, 3),
	(34, 'GRANADILLA', 'gramos', 80, 3),
	(35, 'GUANÁBANA', 'gramos', 56, 3),
	(36, 'LIMA', 'gramos', 27, 3),
	(37, 'MAMEY', 'gramos', 37, 3),
	(38, 'MANDARINA', 'gramos', 35, 3),
	(39, 'MANGO', 'gramos', 60, 3),
	(40, 'MANZANA NACIONAL', 'gramos', 54, 3),
	(41, 'MELOCOTÓN', 'gramos', 64, 3),
	(42, 'MELÓN', 'gramos', 23, 3),
	(43, 'NARANJA', 'gramos', 40, 3),
	(44, 'PALTA', 'gramos', 131, 3),
	(45, 'PAPAYA', 'gramos', 32, 3),
	(46, 'PEPINO DULCE', 'gramos', 26, 3),
	(47, 'PERA DE AGUA', 'gramos', 53, 3),
	(48, 'PIÑA', 'gramos', 38, 3),
	(49, 'PLÁTANO DE SEDA', 'gramos', 83, 3),
	(50, 'SANDÍA', 'gramos', 24, 3),
	(51, 'TORONJA', 'gramos', 36, 3),
	(52, 'UVA VERDE', 'gramos', 66, 3),
	(53, 'UVA NEGRA', 'gramos', 67, 3),
	(54, 'PULPA DE CANGREJO', 'gramos', 94, 4),
	(55, 'LANGOSTINO BLANCO', 'gramos', 68, 4),
	(56, 'ATÚN ENLATADO EN AGUA', 'gramos', 116, 4),
	(57, 'PESCADO BONITO HERVIDO', 'gramos', 138, 4),
	(58, 'PESCADO JUREL HERVIDO', 'gramos', 121, 4),
	(59, 'PESCADO TOYO HERVIDO', 'gramos', 85, 4),
	(60, 'PECHUGA DE GALLINA HERVIDA', 'gramos', 108, 4),
	(61, 'PECHUGA DE POLLO HERVIDA', 'gramos', 119, 4),
	(62, 'PECHUGA DE PAVO HERVIDA', 'gramos', 105, 4),
	(63, 'CARNE DE RES HERVIDA', 'gramos', 105, 4),
	(64, 'CLARA DE HUEVO', 'unidad', 51, 5),
	(65, 'YEMA DE HUEVO', 'unidad', 354, 5),
	(66, 'GARBANZO COCIDO', 'gramos', 99, 6),
	(67, 'HABAS COCIDAS', 'gramos', 102, 6),
	(68, 'LENTEJAS COCIDAS', 'gramos', 97, 6),
	(69, 'PALLAR COCIDO', 'gramos', 103, 6),
	(70, 'CAMOTE AMARILLO HERVIDO', 'gramos', 116, 7),
	(71, 'OLLUCO HERVIDO', 'gramos', 62, 7),
	(72, 'PAPA AMARILLA HERVIDA', 'gramos', 103, 7),
	(73, 'PAPA BLANCA HERVIDA', 'gramos', 97, 7),
	(74, 'QUESO LIGHT', 'gramos', 64, 8),
	(75, 'LECHE DESNATADA', 'mililitros', 37, 8),
	(76, 'YOGURT GRIEGO', 'gramos', 139, 8),
	(77, 'CAFÉ DESCAFEINADO SIN AZÚCAR', 'mililitros', 2, 9),
	(78, 'TÉ SIN AZÚCAR', 'mililitros', 2, 9),
	(79, 'MANZANILLA SIN AZÚCAR', 'mililitros', 1, 9),
	(80, 'ANÍS SIN AZÚCAR', 'mililitros', 1, 9),
	(81, 'HIERBA LUISA SIN AZÚCAR', 'mililitros', 1, 9),
	(82, 'SOYA SIN AZÚCAR', 'mililitros', 35, 9),
	(83, 'JUGO DE LIMÓN SIN AZÚCAR', 'mililitros', 30, 9),
	(84, 'ZUMO DE NARANJA SIN AZÚCAR', 'mililitros', 44, 9);
/*!40000 ALTER TABLE `dim_producto` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.dim_tipo
CREATE TABLE IF NOT EXISTS `dim_tipo` (
  `id` int(11) NOT NULL,
  `alias` varchar(100) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `nombre` varchar(150) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.dim_tipo: ~9 rows (aproximadamente)
/*!40000 ALTER TABLE `dim_tipo` DISABLE KEYS */;
INSERT INTO `dim_tipo` (`id`, `alias`, `nombre`) VALUES
	(1, 'CEREALES', 'CEREALES'),
	(2, 'VERDURAS', 'VERDURAS'),
	(3, 'FRUTAS', 'FRUTAS'),
	(4, 'CARNES', 'CARNES'),
	(5, 'HUEVOS', 'HUEVOS'),
	(6, 'LEGUMBRES', 'LEGUMBRES'),
	(7, 'TUBERCULO', 'TUBERCULO'),
	(8, 'LACTEOS', 'LACTEOS'),
	(9, 'BEBIDAS', 'BEBIDAS');
/*!40000 ALTER TABLE `dim_tipo` ENABLE KEYS */;

-- Volcando estructura para vista nutricion.encryptacion
-- Creando tabla temporal para superar errores de dependencia de VIEW
CREATE TABLE `encryptacion` (
	`SHA2("", 256)` VARCHAR(64) NULL COLLATE 'utf8mb4_general_ci',
	`substring( sha2(uuid(), 256) from 1 for 60)` VARCHAR(60) NULL COLLATE 'utf8mb4_general_ci',
	`SUBSTRING(SHA2(RAND(),256) FROM 1 FOR 60)` VARCHAR(60) NULL COLLATE 'utf8mb4_general_ci'
) ENGINE=MyISAM;

-- Volcando estructura para tabla nutricion.fact_recomendacion
CREATE TABLE IF NOT EXISTS `fact_recomendacion` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `idproducto` int(11) DEFAULT NULL,
  `idhorario` int(11) DEFAULT NULL,
  `maximo` tinyint(4) DEFAULT NULL,
  `obligatorio` tinyint(4) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fact_combinacion_fk` (`idhorario`),
  KEY `fact_combinacion_fk_1` (`idproducto`),
  CONSTRAINT `fact_combinacion_fk` FOREIGN KEY (`idhorario`) REFERENCES `dim_horario` (`id`),
  CONSTRAINT `fact_combinacion_fk_1` FOREIGN KEY (`idproducto`) REFERENCES `dim_producto` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=163 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.fact_recomendacion: ~162 rows (aproximadamente)
/*!40000 ALTER TABLE `fact_recomendacion` DISABLE KEYS */;
INSERT INTO `fact_recomendacion` (`id`, `idproducto`, `idhorario`, `maximo`, `obligatorio`) VALUES
	(1, 2, 1, 1, 1),
	(2, 6, 1, 1, 1),
	(3, 7, 1, 1, 1),
	(4, 8, 1, 1, 1),
	(5, 9, 1, 1, 1),
	(6, 53, 1, 2, 1),
	(7, 32, 1, 2, 1),
	(8, 43, 1, 2, 1),
	(9, 33, 1, 2, 1),
	(10, 44, 1, 2, 1),
	(11, 34, 1, 2, 1),
	(12, 45, 1, 2, 1),
	(13, 35, 1, 2, 1),
	(14, 46, 1, 2, 1),
	(15, 36, 1, 2, 1),
	(16, 47, 1, 2, 1),
	(17, 37, 1, 2, 1),
	(18, 48, 1, 2, 1),
	(19, 38, 1, 2, 1),
	(20, 49, 1, 2, 1),
	(21, 39, 1, 2, 1),
	(22, 50, 1, 2, 1),
	(23, 29, 1, 2, 1),
	(24, 40, 1, 2, 1),
	(25, 51, 1, 2, 1),
	(26, 30, 1, 2, 1),
	(27, 41, 1, 2, 1),
	(28, 52, 1, 2, 1),
	(29, 31, 1, 2, 1),
	(30, 42, 1, 2, 1),
	(31, 64, 1, 2, 1),
	(32, 65, 1, 2, 1),
	(33, 70, 1, 1, 0),
	(34, 74, 1, 1, 0),
	(35, 75, 1, 1, 0),
	(36, 76, 1, 1, 0),
	(37, 81, 1, 1, 1),
	(38, 84, 1, 1, 1),
	(39, 77, 1, 1, 1),
	(40, 78, 1, 1, 1),
	(41, 79, 1, 1, 1),
	(42, 80, 1, 1, 1),
	(43, 8, 2, 1, 0),
	(44, 48, 2, 1, 1),
	(45, 37, 2, 1, 1),
	(46, 49, 2, 1, 1),
	(47, 38, 2, 1, 1),
	(48, 50, 2, 1, 1),
	(49, 39, 2, 1, 1),
	(50, 51, 2, 1, 1),
	(51, 29, 2, 1, 1),
	(52, 40, 2, 1, 1),
	(53, 52, 2, 1, 1),
	(54, 30, 2, 1, 1),
	(55, 41, 2, 1, 1),
	(56, 53, 2, 1, 1),
	(57, 31, 2, 1, 1),
	(58, 42, 2, 1, 1),
	(59, 32, 2, 1, 1),
	(60, 43, 2, 1, 1),
	(61, 33, 2, 1, 1),
	(62, 45, 2, 1, 1),
	(63, 34, 2, 1, 1),
	(64, 46, 2, 1, 1),
	(65, 35, 2, 1, 1),
	(66, 47, 2, 1, 1),
	(67, 36, 2, 1, 1),
	(68, 76, 2, 1, 0),
	(69, 82, 2, 1, 0),
	(70, 83, 2, 1, 0),
	(71, 84, 2, 1, 0),
	(72, 3, 3, 1, 1),
	(73, 4, 3, 1, 1),
	(74, 5, 3, 1, 1),
	(75, 7, 3, 1, 1),
	(76, 1, 3, 1, 1),
	(77, 27, 3, 6, 1),
	(78, 17, 3, 6, 1),
	(79, 28, 3, 6, 1),
	(80, 18, 3, 6, 1),
	(81, 19, 3, 6, 1),
	(82, 20, 3, 6, 1),
	(83, 10, 3, 6, 1),
	(84, 21, 3, 6, 1),
	(85, 11, 3, 6, 1),
	(86, 22, 3, 6, 1),
	(87, 12, 3, 6, 1),
	(88, 23, 3, 6, 1),
	(89, 13, 3, 6, 1),
	(90, 24, 3, 6, 1),
	(91, 14, 3, 6, 1),
	(92, 25, 3, 6, 1),
	(93, 15, 3, 6, 1),
	(94, 26, 3, 6, 1),
	(95, 16, 3, 6, 1),
	(96, 44, 3, 1, 0),
	(97, 62, 3, 1, 1),
	(98, 63, 3, 1, 1),
	(99, 54, 3, 1, 1),
	(100, 55, 3, 1, 1),
	(101, 56, 3, 1, 1),
	(102, 57, 3, 1, 1),
	(103, 58, 3, 1, 1),
	(104, 59, 3, 1, 1),
	(105, 60, 3, 1, 1),
	(106, 61, 3, 1, 1),
	(107, 64, 3, 1, 0),
	(108, 66, 3, 1, 0),
	(109, 67, 3, 1, 0),
	(110, 68, 3, 1, 0),
	(111, 69, 3, 1, 0),
	(112, 70, 3, 1, 0),
	(113, 71, 3, 1, 0),
	(114, 72, 3, 1, 0),
	(115, 73, 3, 1, 0),
	(116, 78, 3, 1, 1),
	(117, 79, 3, 1, 1),
	(118, 80, 3, 1, 1),
	(119, 81, 3, 1, 1),
	(120, 82, 3, 1, 1),
	(121, 8, 4, 1, 0),
	(122, 64, 4, 1, 0),
	(123, 76, 4, 1, 0),
	(124, 82, 4, 1, 0),
	(125, 83, 4, 1, 0),
	(126, 2, 5, 1, 0),
	(127, 4, 5, 1, 0),
	(128, 5, 5, 1, 0),
	(129, 18, 5, 6, 1),
	(130, 19, 5, 6, 1),
	(131, 20, 5, 6, 1),
	(132, 10, 5, 6, 1),
	(133, 21, 5, 6, 1),
	(134, 11, 5, 6, 1),
	(135, 22, 5, 6, 1),
	(136, 12, 5, 6, 1),
	(137, 23, 5, 6, 1),
	(138, 13, 5, 6, 1),
	(139, 24, 5, 6, 1),
	(140, 14, 5, 6, 1),
	(141, 25, 5, 6, 1),
	(142, 15, 5, 6, 1),
	(143, 26, 5, 6, 1),
	(144, 16, 5, 6, 1),
	(145, 27, 5, 6, 1),
	(146, 17, 5, 6, 1),
	(147, 28, 5, 6, 1),
	(148, 56, 5, 1, 1),
	(149, 57, 5, 1, 1),
	(150, 58, 5, 1, 1),
	(151, 59, 5, 1, 1),
	(152, 60, 5, 1, 1),
	(153, 61, 5, 1, 1),
	(154, 62, 5, 1, 1),
	(155, 70, 5, 1, 0),
	(156, 71, 5, 1, 0),
	(157, 78, 5, 1, 1),
	(158, 79, 5, 1, 1),
	(159, 80, 5, 1, 1),
	(160, 81, 5, 1, 1),
	(161, 83, 5, 1, 1),
	(162, 77, 5, 1, 1);
/*!40000 ALTER TABLE `fact_recomendacion` ENABLE KEYS */;

-- Volcando estructura para vista nutricion.productos_buscar
-- Creando tabla temporal para superar errores de dependencia de VIEW
CREATE TABLE `productos_buscar` (
	`id` INT(11) NOT NULL,
	`nombre` VARCHAR(100) NULL COLLATE 'utf8mb4_spanish_ci',
	`medida` VARCHAR(50) NULL COLLATE 'utf8mb4_spanish_ci',
	`kcal` INT(11) NULL,
	`idhorario` INT(11) NOT NULL,
	`horario` VARCHAR(100) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`porcentaje` DECIMAL(5,2) NULL,
	`idtipo` INT(11) NOT NULL,
	`tipo` VARCHAR(100) NULL COLLATE 'utf8mb4_spanish_ci',
	`obligatorio` TINYINT(1) NULL,
	`maximo` SMALLINT(6) NULL
) ENGINE=MyISAM;

-- Volcando estructura para tabla nutricion.tbl_combinacion
CREATE TABLE IF NOT EXISTS `tbl_combinacion` (
  `idcombinacion` int(11) NOT NULL AUTO_INCREMENT,
  `idpersona` int(11) NOT NULL,
  `kcaltotal` decimal(8,2) DEFAULT NULL,
  `fecha` datetime DEFAULT NULL,
  PRIMARY KEY (`idcombinacion`),
  KEY `fk_combinacion_idpersona` (`idpersona`),
  CONSTRAINT `fk_combinacion_idpersona` FOREIGN KEY (`idpersona`) REFERENCES `tbl_persona` (`idpersona`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_combinacion: ~0 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_combinacion` DISABLE KEYS */;
/*!40000 ALTER TABLE `tbl_combinacion` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_combinacion_detalle
CREATE TABLE IF NOT EXISTS `tbl_combinacion_detalle` (
  `idcombinacion` int(11) DEFAULT NULL,
  `idrecomendacion` int(11) DEFAULT NULL,
  `kcal` decimal(7,2) DEFAULT NULL,
  `cantidad` decimal(6,2) DEFAULT NULL,
  KEY `tbl_combinacion_detalle_fk` (`idrecomendacion`),
  KEY `tbl_combinacion_detalle_fk_1` (`idcombinacion`),
  CONSTRAINT `tbl_combinacion_detalle_fk` FOREIGN KEY (`idrecomendacion`) REFERENCES `fact_recomendacion` (`id`),
  CONSTRAINT `tbl_combinacion_detalle_fk_1` FOREIGN KEY (`idcombinacion`) REFERENCES `tbl_combinacion` (`idcombinacion`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_combinacion_detalle: ~0 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_combinacion_detalle` DISABLE KEYS */;
/*!40000 ALTER TABLE `tbl_combinacion_detalle` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_login_tipo
CREATE TABLE IF NOT EXISTS `tbl_login_tipo` (
  `idlogin_tipo` tinyint(4) NOT NULL DEFAULT 0,
  `nombre` varchar(50) COLLATE utf8mb4_spanish_ci NOT NULL,
  PRIMARY KEY (`idlogin_tipo`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_login_tipo: ~3 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_login_tipo` DISABLE KEYS */;
INSERT INTO `tbl_login_tipo` (`idlogin_tipo`, `nombre`) VALUES
	(1, 'NATIVO'),
	(2, 'FACEBOOK'),
	(3, 'GMAIL');
/*!40000 ALTER TABLE `tbl_login_tipo` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_persona
CREATE TABLE IF NOT EXISTS `tbl_persona` (
  `idpersona` int(11) NOT NULL AUTO_INCREMENT,
  `nombres` varchar(150) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `apellidos` varchar(150) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `correo` varchar(150) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `contrasenia` varchar(256) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `kcal` int(11) DEFAULT NULL,
  `token` varchar(200) COLLATE utf8mb4_spanish_ci DEFAULT NULL,
  `fecha_nacimiento` date DEFAULT NULL,
  `sexo` varchar(1) COLLATE utf8mb4_spanish_ci DEFAULT 'F',
  `idlogin_tipo` tinyint(4) DEFAULT NULL,
  PRIMARY KEY (`idpersona`),
  KEY `tbl_persona_logintipo` (`idlogin_tipo`),
  CONSTRAINT `tbl_persona_logintipo` FOREIGN KEY (`idlogin_tipo`) REFERENCES `tbl_login_tipo` (`idlogin_tipo`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_persona: ~2 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_persona` DISABLE KEYS */;
INSERT INTO `tbl_persona` (`idpersona`, `nombres`, `apellidos`, `correo`, `contrasenia`, `kcal`, `token`, `fecha_nacimiento`, `sexo`, `idlogin_tipo`) VALUES
	(1, 'JUAN', 'PÉREZ', 'jperez@hotmail.com', '8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92', 2533, '8b77fa9fa3813aee21e79ac7aea98b8b045981c052689f21f6c4c47ca292', '1996-03-21', 'M', 1),
	(9, 'Daniel', 'Vilchez Guivar', 'dv780@hotmail.com', 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', NULL, 'd4750a7bf88cbb9fe54cea9fe74dcbda642d9135053f6f7d9ceee94422c7db54', '1996-03-30', 'F', 2);
/*!40000 ALTER TABLE `tbl_persona` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_persona_medida
CREATE TABLE IF NOT EXISTS `tbl_persona_medida` (
  `idmedida` int(11) NOT NULL AUTO_INCREMENT,
  `idpersona` int(11) NOT NULL,
  `peso` int(11) NOT NULL DEFAULT 0,
  `medida` decimal(6,2) NOT NULL DEFAULT 0.00,
  `cintura` int(11) NOT NULL DEFAULT 0,
  `cadera` int(11) NOT NULL DEFAULT 0,
  `imc` decimal(6,2) NOT NULL DEFAULT 0.00,
  `fecha` date DEFAULT NULL,
  PRIMARY KEY (`idmedida`),
  KEY `fk_persona_medida_idperson` (`idpersona`),
  CONSTRAINT `fk_persona_medida_idperson` FOREIGN KEY (`idpersona`) REFERENCES `tbl_persona` (`idpersona`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_persona_medida: ~1 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_persona_medida` DISABLE KEYS */;
INSERT INTO `tbl_persona_medida` (`idmedida`, `idpersona`, `peso`, `medida`, `cintura`, `cadera`, `imc`, `fecha`) VALUES
	(6, 1, 70, 1.64, 100, 100, 28.91, '2019-12-20'),
	(7, 9, 74, 1.64, 100, 100, 27.52, '2019-12-20'),
	(8, 9, 100, 1.60, 100, 100, 39.07, '2019-12-22');
/*!40000 ALTER TABLE `tbl_persona_medida` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_persona_preferencia
CREATE TABLE IF NOT EXISTS `tbl_persona_preferencia` (
  `idpersona` int(11) NOT NULL,
  `cant_comidas` tinyint(4) NOT NULL DEFAULT 0,
  `cant_vasos` tinyint(4) NOT NULL DEFAULT 0,
  `comida_hambre` enum('FRUTA','COMIDA RAPIDA','GOLOSINAS','CEREALES','NINGUNA') COLLATE utf8mb4_spanish_ci NOT NULL,
  `hace_dieta` tinyint(4) NOT NULL DEFAULT 0,
  PRIMARY KEY (`idpersona`),
  CONSTRAINT `fk_persona_preferencia_idpersona` FOREIGN KEY (`idpersona`) REFERENCES `tbl_persona` (`idpersona`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_persona_preferencia: ~0 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_persona_preferencia` DISABLE KEYS */;
INSERT INTO `tbl_persona_preferencia` (`idpersona`, `cant_comidas`, `cant_vasos`, `comida_hambre`, `hace_dieta`) VALUES
	(1, 3, 1, 'COMIDA RAPIDA', 0),
	(9, 3, 5, 'GOLOSINAS', 0);
/*!40000 ALTER TABLE `tbl_persona_preferencia` ENABLE KEYS */;

-- Volcando estructura para tabla nutricion.tbl_persona_rutina
CREATE TABLE IF NOT EXISTS `tbl_persona_rutina` (
  `idpersona` int(11) NOT NULL,
  `caminar` tinyint(4) NOT NULL DEFAULT 0,
  `escaleras` tinyint(4) NOT NULL DEFAULT 0,
  `trabaja` tinyint(4) NOT NULL DEFAULT 0,
  `trabaja_casa` tinyint(4) NOT NULL DEFAULT 0,
  `trabaja_ligero` tinyint(4) NOT NULL DEFAULT 0,
  `trabaja_activo` tinyint(4) NOT NULL DEFAULT 0,
  `trabaja_muyactivo` tinyint(4) NOT NULL DEFAULT 0,
  `ciclismo` tinyint(4) NOT NULL DEFAULT 0,
  `futbol` tinyint(4) NOT NULL DEFAULT 0,
  `danza` tinyint(4) NOT NULL DEFAULT 0,
  `baloncesto` tinyint(4) NOT NULL DEFAULT 0,
  `natacion` tinyint(4) NOT NULL DEFAULT 0,
  `tenis` tinyint(4) NOT NULL DEFAULT 0,
  `correr` tinyint(4) NOT NULL DEFAULT 0,
  PRIMARY KEY (`idpersona`),
  CONSTRAINT `fk_persona_rutina_idpersona` FOREIGN KEY (`idpersona`) REFERENCES `tbl_persona` (`idpersona`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_spanish_ci;

-- Volcando datos para la tabla nutricion.tbl_persona_rutina: ~2 rows (aproximadamente)
/*!40000 ALTER TABLE `tbl_persona_rutina` DISABLE KEYS */;
INSERT INTO `tbl_persona_rutina` (`idpersona`, `caminar`, `escaleras`, `trabaja`, `trabaja_casa`, `trabaja_ligero`, `trabaja_activo`, `trabaja_muyactivo`, `ciclismo`, `futbol`, `danza`, `baloncesto`, `natacion`, `tenis`, `correr`) VALUES
	(1, 7, 2, 1, 5, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0),
	(9, 0, 0, 1, 0, 0, 1, 0, 0, 0, 3, 0, 0, 0, 0);
/*!40000 ALTER TABLE `tbl_persona_rutina` ENABLE KEYS */;

-- Volcando estructura para vista nutricion.encryptacion
-- Eliminando tabla temporal y crear estructura final de VIEW
DROP TABLE IF EXISTS `encryptacion`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `encryptacion` AS SELECT  SHA2("", 256), substring( sha2(uuid(), 256) from 1 for 60),  SUBSTRING(SHA2(RAND(),256) FROM 1 FOR 60) ;

-- Volcando estructura para vista nutricion.productos_buscar
-- Eliminando tabla temporal y crear estructura final de VIEW
DROP TABLE IF EXISTS `productos_buscar`;
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `productos_buscar` AS SELECT p.id, p.nombre,p.medida, kcal,h.id AS idhorario, h.alias AS horario, h.porcentaje, t.id AS idtipo, t.alias AS tipo,ht.obligatorio, ht.maximo FROM dim_producto p 
INNER JOIN dim_tipo t ON p.idtipo = t.id
INNER JOIN dim_horario_producto_restriccion hp ON hp.idproducto = p.id
INNER JOIN dim_horario h ON h.id = hp.idhorario
INNER JOIN dim_horario_tipo_restriccion ht ON ht.idtipo = t.id AND ht.idhorario = h.id
WHERE hp.consumir = 1 AND ht.maximo >0 
order by h.id , t.id,  ht.obligatorio desc ;

/*!40101 SET SQL_MODE=IFNULL(@OLD_SQL_MODE, '') */;
/*!40014 SET FOREIGN_KEY_CHECKS=IF(@OLD_FOREIGN_KEY_CHECKS IS NULL, 1, @OLD_FOREIGN_KEY_CHECKS) */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
